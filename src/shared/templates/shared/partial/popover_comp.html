<div class="popover popover-comp popover-scrollable" id="compPop">
    <div role="document">
        <button type="button" class="close" data-cfw-dismiss="popover" aria-label="Close" title="Close"><span class="icon-cancel-circled2" aria-hidden="true"></span></button>
        <!-- <span role="button" tabindex="0" class="drag" data-cfw-drag="popover" aria-label="Move" title="Move"><span aria-hidden="true">+</span></span> -->
        <div class="popover-header">
            <strong>Clue us in!</strong>
        </div>
        <div class="popover-body">
            <form id="comprehensionCheckForm">
                <p>How much did you learn from this reading?</p>
                <div class="form-inline">
                    <div class="form-check form-checkradio me-1">
                        <input id="compRadio0-0" class="form-check-input" type="radio" name="comprehension-scale" value="2">
                        <label for="compRadio0-0" class="form-check-label">A lot</label>
                    </div>
                    <div class="form-check form-checkradio me-1">
                        <input id="compRadio0-1" class="form-check-input" type="radio" name="comprehension-scale" value="1">
                        <label for="compRadio0-1" class="form-check-label">A little</label>
                    </div>
                    <div class="form-check form-checkradio me-1">
                        <input id="compRadio0-2" class="form-check-input" type="radio" name="comprehension-scale" value="0">
                        <label for="compRadio0-2" class="form-check-label">Nothing</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="compText0" class="form-label">What's one thing you learned?</label>
                    <div class="stt-wrapper">
                        <textarea id="compText0" class="form-control" name="comprehension-free"></textarea>
                        <a href="#" role="button" class="stt-btn" data-cast="stt" data-target="#compText0"><span class="icon-mic" aria-hidden="true"></span><span class="sr-only">Use Speech to Text</span></a>
                    </div>
                </div>
                <button class="btn btn-primary" id="comprehensionCheckSubmit">Save</button>
            </form>
        </div>
    </div>
</div>

<script>
$("#comprehensionCheckSubmit").click(function (e) {
    e.preventDefault();
    console.log("comprehension check submit was clicked");    
    var scaleResponse = $('input[name="comprehension-scale"]:checked').val();    
    var freeResponse = $('textarea[name="comprehension-free"]').val();
    var comprehensionResponse = {
        scaleResponse: scaleResponse,
        freeResponse: freeResponse,        
        bookVersionId: clusiveContext.reader.info.publication.version_id,        
        bookId: clusiveContext.reader.info.publication.id,
        eventId: PAGE_EVENT_ID
    }

    $.ajax("/assessment/comprehension_check", {
            method: "POST",
            headers: {
                'X-CSRFToken': DJANGO_CSRF_TOKEN
            },
            data: JSON.stringify(comprehensionResponse)
        })
            .done(function(data) {
                console.log("done", data);
            })
            .fail(function(err) {
                console.log("fail", err);
            });

});
</script>